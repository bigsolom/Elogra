<script type="text/javascript">
    var moreActionURL = "<?= $this->url(array('controller' => 'hakawy', 'action' => 'more'), 'default', true) ?>";
    function addHekaya(){
           $.ajax({
                url: "<?= $this->url(array('controller' => 'hakawy', 'action' => 'submit'), 'default', true) ?>",
                dataType: "json", 
                data: $('#hekayaForm').serialize(),
                beforeSend:function(){ //disable button and field
                   $('#taxiTalksInput').attr("disabled","disabled");
                   $('#hekayaButton').attr("disabled","disabled");
                },
                complete: function(){//enable them back
                    $('#taxiTalksInput').attr("value","");
                    $('#taxiTalksInput').removeAttr("disabled");
                    $('#hekayaButton').removeAttr("disabled");
                },
                success: function(data) {
                    $(".container").prepend(data.html);
                }
             });
        }
        /* when the dom is ready... */
$(document).ready(function(){
	/* hide all controls right away */
	$('div.record-controls').css('visibility','hidden');
	/* add events for show/hide */
	$('div.record').each(function() {
		var controls = $(this).children('div.record-controls');
		$(this).hover(
			function() { $(controls).css('visibility','visible') },
			function() { $(controls).css('visibility','hidden') }
		);
	});
});


</script>
<script type="text/javascript" src="/js/pagination.js"></script>
<form id="hekayaForm" method="post" onsubmit="addHekaya(); return false;" class="well">
    <fieldset>
<textarea class="expand" 
id="taxiTalksInput" name="taxiTalksInput" maxlength="500"  onfocus="OnFocusInput(this)" onblur="OnBlurInput(this)" placeholder="قول للناس حدوتك"></textarea>
    <input type="submit" name="button" id="hekayaButton" value="<?=  Application_Service_Translate::_('share')?>" class="btn btn-large" />
	 </fieldset>
</form>
<script type="text/javascript" src="/js/charcount.js"></script>

<!-- YAMLI CODE START -->
<script type="text/javascript" src="http://api.yamli.com/js/yamli_api.js"></script>

		<script type="text/javascript">
  if (typeof(Yamli) == "object" && Yamli.init( { uiLanguage: "ar" , startMode: "offOrUserDefault" } ))
  {
    Yamli.yamlify( "taxiTalksInput", { settingsPlacement: "inside" } );
  }
</script>

<div class="paginated" data-page="1" data-status="idle">
    <?php
    foreach ($this->hakawy as $hekaya) {
        ?>
            <?= $this->partial('partials/_hekaya.phtml', array('hekaya' => $hekaya)); ?>
            
        <?php
    }
    ?>
       
</div>
